call pathogen#infect()
filetype plugin on

function FixCommentsListForCLang()
	" add :/// to comments, but make sure that it has a higher priority than
	set comments-=:// comments+=:///,://
endfunction
com FixCommentsListForCLang call FixCommentsListForCLang()

function LowColor()
	set t_Co=8
	colo default
endfunction
com LowColor call LowColor()

function! SwitchSourceHeader()
	"update!
	if (expand ("%:e") == "h")
		if (filereadable(expand("%:r") . ".c"))
			find %:r.c
		else
			find %:r.cpp
		endif
	else
		find %:r.h
	endif
endfunction
nmap ,s :call SwitchSourceHeader()<CR>

"config and keybindings for BufExplorer plugin
let g:bufExplorerSortBy='name'

"prevent V-s from being mapped by surround plugin
" (the plugin would just display a deprecation warning anyway)
vnoremap s s

"filetype plugin on
set autoindent
set background=dark
set cindent
set fo=tcroq
set hlsearch
set incsearch
set ignorecase smartcase
set laststatus=2
set linebreak
set mouse=a
set number
set shiftwidth=4
set smarttab
set statusline=%<%f\ %#Search#\ %Y%M%R\ %*\ %{fugitive#statusline()}%=\ %-14.(%l,%c%V%)\ %P
set tabstop=4
set wildmode=longest:full
set wildmenu
syntax enable

" remove highlighting of search matches
nmap , :let @/=""<CR>:<BS>
" after repeating commands, put the cursor at the start of the change
nmap . .`[
" after adjusting indentation in visual mode, restore selection for further changes
vnoremap > >gv
vnoremap < <gv
" disable q: command for opening the command line window
map q: <Nop>
" change mouse mode with function keys
nmap <F9> :set mouse=<CR>
nmap <F10> :set mouse=a<CR>

" setup color scheme, highlight interesting whitespace
set t_Co=256
if $TERM == "xterm-256color"
	let g:ConqueTerm_TERM = 'xterm-256color'
endif

if hostname() == "ptpcp11"
	autocmd ColorScheme * highlight MyTab ctermbg=242
	autocmd ColorScheme * highlight MySpace ctermbg=245
else
	autocmd ColorScheme * highlight MyTab ctermbg=235
	autocmd ColorScheme * highlight MySpace ctermbg=238
endif

let g:gardener_light_comments=1
colo gardener-transparent

autocmd Syntax * syntax match MyTab /^\t\+/
autocmd Syntax * syntax match MySpace /\s\+$/

"formatting style for Python code and changelogs in our working group
autocmd FileType python setlocal expandtab smarttab nocindent tabstop=4 softtabstop=4
autocmd FileType python map <F5> :w<CR>:!python "%"<CR>
autocmd FileType changelog setlocal expandtab smarttab tabstop=4 softtabstop=4

autocmd FileType tex map <F5> :w<CR>:wa<CR>:make<CR>
autocmd FileType tex map <F6> :!xdg-open %<.pdf &>/dev/null &disown<CR><CR>
autocmd FileType tex setlocal nocindent

" enable pair matching for angle brackets (e.g. C++ templates)
autocmd FileType cpp setlocal matchpairs+=<:>
